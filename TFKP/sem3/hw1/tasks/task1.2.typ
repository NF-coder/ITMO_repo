#let frame(stroke) = (x, y) => (
  left: if x > 0 { 0pt } else { stroke },
  right: stroke,
  top: if y < 1 { stroke } else { 0pt },
  bottom: stroke,
)

* Задание 1.2 * \

Пусть
$
  g(t) = cases(
    2 quad t in [4, 8],
    0 quad t in.not [4, 8]
  )\
  u(t) = g(t) + 0 dot xi(t) + 2 dot sin (10 dot t)\

  a = 2, space t_1 = 4, space t_2 = 8, space b = 0, space c = 2, space d = 10
$
Применятеся фильтр первого порядка с формулой
$
  W_2(p)=(p^2 + a_1 p + a_2) / (p^2 + b_1 p + b_2)
$

Рассчёт коэффициентов:
1. #block(width: 100%)[
  Для подавления частоты $ω_0$ числитель должен обращаться в ноль при $p = i ω_0$:
  $
    (i w_0)^2 + a_1 (i w_0) + a_2 = - w_0^2 + i a w_0 + a_2 = 0\
    a_2 = w_0^2 = 100, a_1 = 0
  $
]
2. #block(width: 100%)[
  Условие единичного усиления на нулевой и бесконечной частотах 
  $
    W(0) = a_2/b_2 = 1 => b_2 = a_2 = 100
  $
]
3. #block(width: 100%)[
  Условие устойчивости
  $
    p^2 + b_1 p + b_2 = 0
  $
  При $b_2=100$ устойчивость обеспечивается при $b_1 > 0$\
  Выберу, например, $b_1 = 2$
]
Итого получаем фильтр
$
  W_2(p) = (p^2 + 100)/(p^2 + 2 p +100)
$

Выводы:
1. #block(width: 100%)[
  Режекторный фильтр эффективно подавляет гармоническую помеху при $omega = omega_0$
]
2. #block(width: 100%)[
  При $d=ω_0$ наблюдается максимальное подавление синусоидальной составляющей.
]
3. #block(width: 100%)[
  Параметр $b_1$ определяет ширину полосы подавления:\
  a. малый $b_1$ -- узкая режекция\
  b. большой $b_1$ -- более агрессивное подавление
]


#figure(
  table(
    columns: 2,
    stroke: frame(1pt + rgb("#4e4e4e")),
    [#image("../t1.2-1/signals_1.2_(b1=0.15;d=10).svg", width: 95%)],
    [#image("../t1.2-1/signals_1.2_(b1=0.25;d=10).svg", width: 95%)],
    [#image("../t1.2-1/signals_1.2_(b1=1;d=10).svg", width: 95%)],
    [#image("../t1.2-1/signals_1.2_(b1=2;d=10).svg", width: 95%)],
    [#image("../t1.2-1/signals_1.2_(b1=5;d=10).svg", width: 95%)],
    [#image("../t1.2-1/signals_1.2_(b1=20;d=10).svg", width: 95%)],
  ),
  caption: [Сравнительные графики при фиксированом $d$, но различных $b_1$],
)

#figure(
  table(
    columns: 2,
    stroke: frame(1pt + rgb("#4e4e4e")),
    [#image("../t1.2-2/signals_1.2_(b1=2;d=5).svg", width: 95%)],
    [#image("../t1.2-2/signals_1.2_(b1=2;d=8).svg", width: 95%)],
    [#image("../t1.2-2/signals_1.2_(b1=2;d=10).svg", width: 95%)],
    [#image("../t1.2-2/signals_1.2_(b1=2;d=12).svg", width: 95%)],
  ),
  caption: [Сравнительные графики при фиксированом $b_1$, но различных $d$],
)
